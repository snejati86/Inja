<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link href='https://fonts.googleapis.com/css?family=Roboto:100' rel='stylesheet' type='text/css'>


<dom-module id="login-button">
    <template>
        <style>
            :host {
                display: block;
                box-sizing: border-box;
            }

        </style>
        <paper-button raised><span>[[service]]</span></paper-button>

    </template>

    <script>
        (function() {
            'use strict';

            window.fbAsyncInit = function() {

                FB.init({
                    appId: '798090136940551',
                    cookie: true,  // enable cookies to allow the server to access
                                   // the session
                    xfbml: true,  // parse social plugins on this page
                    version: 'v2.2' // use version 2.2
                });
            };

            Polymer({
                is: 'login-button',
                listeners : {
                    'tap':'checkLoginState'
                },
                properties: {
                    service: String
                },
                ready: function() {
                    console.log('Login button ready');

                    // Load the SDK asynchronously

                },
                // This function is called when someone finishes with the Login
                // Button.  See the onlogin handler attached to it in the sample
                // code below.
                checkLoginState:function() {
                    console.log('Tapped');
                    FB.getLoginStatus(function (response) {
                        statusChangeCallback(response);
                    });
                }

            });

            function statusChangeCallback(response) {
                console.log(response);
                // The response object is returned with a status field that lets the
                // app know the current login status of the person.
                // Full docs on the response object can be found in the documentation
                // for FB.getLoginStatus().
                if (response.status === 'connected') {
                    console.log('WE ARE CONECTED');
                } else if (response.status === 'not_authorized') {
                    FB.login();
                    console.log('WE ARE NOT CONNECTED');
                } else {
                    // The person is not logged into Facebook, so we're not sure if
                    // they are logged into this app or not.
                   console.log('HEY MAN, I DONT KNOW THE FUCK IS GOING ON HERE');
                }
            }
        })();
    </script>
</dom-module>